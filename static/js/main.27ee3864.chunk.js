(this.webpackJsonpwhatsapp=this.webpackJsonpwhatsapp||[]).push([[0],{104:function(e,t,a){},105:function(e,t,a){},106:function(e,t,a){},111:function(e,t,a){"use strict";a.r(t);var c=a(4),n=a(2),s=a.n(n),r=a(28),i=a.n(r),j=(a(79),a(11)),o=(a(80),a(45)),d=a.n(o),b=a(60),u=a(23),h=a(128),l=a(123),O=a(124),p=a(125),m=a(126),x=a(63),f=a.n(x),g=a(64),v=a.n(g),w=(a(82),a(9)),N=Object(n.createContext)(),S=function(e){var t=e.reducer,a=e.initialState,s=e.children;return Object(c.jsx)(N.Provider,{value:Object(n.useReducer)(t,a),children:s})},_=function(){return Object(n.useContext)(N)},y=a(62),C=a.n(y).a.create({baseURL:"https://young-woodland-89279.herokuapp.com"}),I=a(37),E=a.n(I);var L=function(){var e=Object(n.useState)(""),t=Object(j.a)(e,2),a=t[0],s=t[1],r=Object(w.f)().roomId,i=Object(n.useState)(""),o=Object(j.a)(i,2),x=o[0],g=o[1],N=Object(n.useState)([]),S=Object(j.a)(N,2),y=S[0],I=S[1],L=_(),D=Object(j.a)(L,1)[0].user;Object(n.useEffect)((function(){C.get("/api/v1/messages/sync/".concat(r)).then((function(e){return I(e.data.message)})),C.get("/whatsapp/rooms/sync/".concat(r)).then((function(e){g(e.data.room.name)}))}),[r]),Object(n.useEffect)((function(){s(Math.floor(5e3*Math.random()))}),[r]),Object(n.useEffect)((function(){var e=new E.a("c749c0a525d952c26b14",{cluster:"eu"}).subscribe("message");return e.bind("inserted",(function(e){I([].concat(Object(u.a)(y),[e]))})),function(){e.unbind_all(),e.unsubscribe()}}),[y]);var k=Object(n.useState)(""),M=Object(j.a)(k,2),R=M[0],P=M[1],U=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),C.post("/api/v1/messages/new/".concat(r),{message:R,name:D.displayName}),P("");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function A(e){var t=e.getHours(),a=e.getMinutes(),c=t>=12?"pm":"am";return(t=(t%=12)||12)+":"+(a=a<10?"0"+a:a)+" "+c}var B=y.length>0?new Date(y[y.length-1].timestamp).toDateString():null,F=(new Date).toDateString(),T=y.length>0?new Date(y[y.length-1].timestamp):null;return Object(c.jsxs)("div",{className:"chat",children:[Object(c.jsxs)("div",{className:"chat_header",children:[Object(c.jsx)(h.a,{src:"https://avatars.dicebear.com/api/human/".concat(a,".svg")}),Object(c.jsxs)("div",{className:"chat_headerInfo",children:[Object(c.jsx)("h3",{children:x}),Object(c.jsxs)("p",{children:["Last seen at ",null!==B?F.toString().toLowerCase()===B.toString().toLowerCase()?A(T):A(B):null]})]}),Object(c.jsxs)("div",{className:"chat_headerRight",children:[Object(c.jsx)(l.a,{children:Object(c.jsx)(O.a,{})}),Object(c.jsx)(l.a,{children:Object(c.jsx)(p.a,{})}),Object(c.jsx)(l.a,{children:Object(c.jsx)(m.a,{})})]})]}),Object(c.jsx)("div",{className:"chat_body",children:y.length>0?y.map((function(e){return Object(c.jsxs)("p",{className:"chat_message ".concat(e.name===D.displayName&&"chat_receiver"),children:[Object(c.jsx)("span",{className:"chat_name",children:e.name}),e.message,Object(c.jsx)("span",{className:"chat_timestamp",children:A(new Date(e.timestamp))})]},e.id)})):null}),Object(c.jsxs)("div",{className:"chat_footer",children:[Object(c.jsx)(f.a,{}),Object(c.jsxs)("form",{children:[Object(c.jsx)("input",{type:"text",value:R,onChange:function(e){return P(e.target.value)},placeholder:"Type a message"}),Object(c.jsx)("button",{type:"submit",onClick:U,children:"Send a message"})]}),Object(c.jsx)(v.a,{})]})]})},D=(a(104),a(65)),k=a.n(D),M=a(66),R=a.n(M),P=a(67),U=a.n(P),A=a(32);a(105);var B=function(e){var t,a=e.addNewChat,s=e.id,r=e.name,i=Object(n.useState)(""),o=Object(j.a)(i,2),d=o[0],b=o[1],u=Object(n.useState)(""),l=Object(j.a)(u,2),O=l[0],p=l[1];return Object(n.useEffect)((function(){b(Math.floor(5e3*Math.random()))}),[]),Object(n.useEffect)((function(){C.get("/api/v1/messages/sync/".concat(s)).then((function(e){return p(e.data.message)}))}),[s,O]),a?Object(c.jsx)("div",{onClick:function(){var e=prompt("Please enter name for chat room");e&&C.post("/whatsapp/rooms/new",{name:e})},className:"sidebarChat",children:Object(c.jsx)("h2",{children:"Add New Chat"})}):Object(c.jsx)(A.b,{to:"/rooms/".concat(s),children:Object(c.jsxs)("div",{className:"sidebarChat",children:[Object(c.jsx)(h.a,{src:"https://avatars.dicebear.com/api/human/".concat(d,".svg")}),Object(c.jsxs)("div",{className:"sidebarChat_info",children:[Object(c.jsx)("h2",{children:r}),Object(c.jsx)("p",{children:null===(t=O[O.length-1])||void 0===t?void 0:t.message})]})]})})};var F=function(){var e=Object(n.useState)([]),t=Object(j.a)(e,2),a=t[0],s=t[1],r=_(),i=Object(j.a)(r,1)[0].user;return Object(n.useEffect)((function(){var e=new E.a("c749c0a525d952c26b14",{cluster:"eu"}).subscribe("room");return e.bind("inserted",(function(e){s([].concat(Object(u.a)(a),[e]))})),function(){e.unbind_all(),e.unsubscribe()}}),[a]),Object(n.useEffect)((function(){C.get("/whatsapp/rooms/sync").then((function(e){s(e.data.room)}))}),[]),Object(c.jsxs)("div",{className:"sidebar",children:[Object(c.jsxs)("div",{className:"sidebar_header",children:[Object(c.jsx)(h.a,{src:null===i||void 0===i?void 0:i.photoURL}),Object(c.jsxs)("div",{className:"sidebar_headerRight",children:[Object(c.jsx)(l.a,{children:Object(c.jsx)(k.a,{})}),Object(c.jsx)(l.a,{children:Object(c.jsx)(R.a,{})}),Object(c.jsx)(l.a,{children:Object(c.jsx)(U.a,{})})]})]}),Object(c.jsx)("div",{className:"sidebar_search",children:Object(c.jsxs)("div",{className:"sidebar_searchContainer",children:[Object(c.jsx)(O.a,{}),Object(c.jsx)("input",{type:"text",placeholder:"Search or start new chat"})]})}),Object(c.jsxs)("div",{className:"sidebar_chats",children:[Object(c.jsx)(B,{addNewChat:!0}),a.map((function(e){return Object(c.jsx)(B,{id:e._id,name:e.name},e._id)}))]})]})},T=a(68),z=a(127),G=(a(106),a(40)),H=(G.a.initializeApp({apiKey:"AIzaSyAYjI3Xa9-g2B7yL-Hb2Mi4avglUGh5qUs",authDomain:"whatsapp-mern-dad7e.firebaseapp.com",databaseURL:"https://whatsapp-mern-dad7e.firebaseio.com",projectId:"whatsapp-mern-dad7e",storageBucket:"whatsapp-mern-dad7e.appspot.com",messagingSenderId:"47599962661",appId:"1:47599962661:web:14ead55b4d3367e9a1cdcc"}).firestore(),G.a.auth()),J=new G.a.auth.GoogleAuthProvider,W=a(48),q="SET_USER",K=function(e,t){switch(t.type){case q:return Object(W.a)(Object(W.a)({},e),{},{user:t.user});default:return e}};var X=function(){var e=_(),t=Object(j.a)(e,2);Object(T.a)(t[0]);var a=t[1];return Object(c.jsx)("div",{className:"login",children:Object(c.jsxs)("div",{className:"login_container",children:[Object(c.jsx)("img",{src:"https://i.pinimg.com/originals/99/0b/7d/990b7d2c2904f8cd9bc884d3eed6d003.png",alt:"Whatsapp Logo"}),Object(c.jsx)("div",{className:"login_text",children:Object(c.jsx)("h1",{children:"Sign in to whatsapp"})}),Object(c.jsx)(z.a,{type:"submit",onClick:function(){H.signInWithPopup(J).then((function(e){return a({type:q,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign in with google"})]})})};var Y=function(){var e=_(),t=Object(j.a)(e,1)[0].user;return Object(c.jsx)("div",{className:"app",children:t?Object(c.jsx)("div",{className:"app_body",children:Object(c.jsxs)(A.a,{children:[Object(c.jsx)(F,{}),Object(c.jsxs)(w.c,{children:[Object(c.jsx)(w.a,{exact:!0,path:"/rooms/:roomId",children:Object(c.jsx)(L,{})}),Object(c.jsx)(w.a,{exact:!0,path:"/app",children:Object(c.jsx)(L,{})})]})]})}):Object(c.jsx)(X,{})})},Q=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,129)).then((function(t){var a=t.getCLS,c=t.getFID,n=t.getFCP,s=t.getLCP,r=t.getTTFB;a(e),c(e),n(e),s(e),r(e)}))};i.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(S,{initialState:{user:null},reducer:K,children:Object(c.jsx)(Y,{})})}),document.getElementById("root")),Q()},79:function(e,t,a){},80:function(e,t,a){},82:function(e,t,a){}},[[111,1,2]]]);
//# sourceMappingURL=main.27ee3864.chunk.js.map